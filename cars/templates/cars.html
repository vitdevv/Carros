{% load humanize %}

<script src="https://cdn.tailwindcss.com"></script>

<script>
  tailwind.config = {
    darkMode: 'class'
  }

  // Load saved theme
  if (localStorage.theme === 'dark') {
    document.documentElement.classList.add('dark')
  }

  function toggleDarkMode() {
    document.documentElement.classList.toggle('dark')
    localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light'
  }
</script>

{% block content %}

<div class="min-h-screen bg-white dark:bg-black transition text-gray-900 dark:text-gray-100">

  <!-- Dark Mode Toggle -->
  <button onclick="toggleDarkMode()" 
    class="fixed top-6 left-6 px-4 py-2 rounded-full border text-sm font-medium 
           bg-white text-black border-gray-300 
           dark:bg-black dark:text-white dark:border-gray-700 
           hover:scale-105 transition shadow z-50">
    Toggle Dark Mode
  </button>

  <div class="max-w-6xl mx-auto px-6 py-14">

    <!-- Title -->
    <h1 class="text-3xl font-semibold tracking-tight text-center mb-10">
      Explore Cars
    </h1>

    <!-- Search -->
    <form method="GET" action="{% url 'cars_list' %}" class="flex justify-center mb-14">
      <input 
        type="text" 
        name="search" 
        placeholder="Search cars..." 
        class="w-full max-w-lg px-5 py-3 text-gray-800 dark:text-gray-200 
               border border-gray-300 dark:border-gray-700 
               bg-white dark:bg-gray-900 rounded-full 
               focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-white transition"
      >
    </form>

    <!-- Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">

      {% if cars %}
        {% for car in cars %}
          <a href="{% url 'car_details' car.id %}" class="group block">

            <div class="cursor-pointer">

              <!-- Image -->
              <div class="rounded-2xl overflow-hidden bg-gray-100 dark:bg-gray-800">
                <img 
                  src="{{ car.image.url }}" 
                  alt="{{ car.model }}"
                  class="w-full h-64 object-cover transition-transform duration-700 group-hover:scale-[1.03]"
                >
              </div>

              <!-- Info -->
              <div class="mt-4">
                <h2 class="text-lg font-medium">
                  {{ car.brand }} {{ car.model }}
                </h2>

                <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                  {{ car.factory_year }}
                </p>

                <p class="text-lg font-semibold mt-2">
                  R$ {{ car.value|floatformat:0|intcomma }}
                </p>
              </div>

            </div>

          </a>
        {% endfor %}
      {% else %}
        <p class="text-center text-gray-500 col-span-full text-lg">
          No cars found.
        </p>
      {% endif %}

    </div>

  </div>

</div>

{% endblock %}
